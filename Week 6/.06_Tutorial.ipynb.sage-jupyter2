{"backend_state":"init","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-4a374951-cac3-483d-bbcf-ebda71e3e9e1.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":1,"id":"660969","input":"import csv\nimport matplotlib.pyplot as plt\n#step 1\nx =[]\ny =[]\nmag =[]\nstar_name = []\nwith open(\"stars.csv\") as f:\n    b = csv.reader(f)\n    next(b)\n    r = [i for i in b]\n    x = [float(row[0]) for row in r]\n    y = [float(row[1]) for row in r]\n    mag = [float(row[4]) for row in r]\n    star_name = [row[5].split(\";\")[-1].strip() for row in r]\n\n# print(star_name)\n# print(x[0:10])\n# print(y[0:10])\n# print(len(x),len(y),len(mag))\n\n# step 2\nfig, ax = plt.subplots(figsize=(5,5))\nfig.patch.set_facecolor(\"black\") \nax.axis(\"off\") \nax.set_facecolor(\"black\") \nax.scatter(x,y,s=0.5,c='#2ca02c')\n\n\n#step 3\nwith open(\"Cas_lines.txt\") as s:\n    stars_lst = []\n    for row in s:\n        stars_lst.append(row.replace(\"\\n\",\"\").split(\",\"))\n#print(stars_lst)\nx_coor = []\ny_coor = []\nfor star in stars_lst:\n    star1 = star[0]\n    star2 = star[1]\n    n1 = star_name.index(star1)\n    n2 = star_name.index(star2)\n    x_coor.append(x[n1])\n    y_coor.append(y[n2])\n# print(x_coor)\n# print(y_coor)\nax.plot(x_coor, y_coor, c = '#d62728' )\nplt.show()","output":{"0":{"data":{"image/png":"63ae2140055a2a6b4223b0c3388805dd76b09b54","text/plain":"<Figure size 360x360 with 1 Axes>"},"exec_count":1,"metadata":{"image/png":{"height":286,"width":293}},"output_type":"execute_result"}},"pos":4,"type":"cell"}
{"cell_type":"code","exec_count":12,"id":"5651ff","input":"#step 1\nstop_codon = [\"UAA\",\"UAG\",\"UGA\"]\ngenetic_code = ['GCA', 'GCC', 'GCG', 'GCU', 'UGC', 'UGU', 'GAC', 'GAU', 'GAA',\n                'GAG', 'UUC', 'UUU', 'GGA', 'GGC', 'GGG', 'GGU', 'CAC', 'CAU',\n                'AUA', 'AUC', 'AUU', 'AAA', 'AAG', 'UUA', 'UUG', 'CUA', 'CUC',\n                'CUG', 'CUU', 'AUG', 'AAC', 'AAU', 'CCA', 'CCC', 'CCG', 'CCU',\n                'CAA', 'CAG', 'AGA', 'AGG', 'CGA', 'CGC', 'CGU', 'CGG', 'AGC',\n                'AGU', 'UCA', 'UCC', 'UCG', 'UCU', 'ACA', 'ACC', 'ACG', 'ACU',\n                'GUA', 'GUC', 'GUG', 'GUU', 'UGG', 'UAC', 'UAU', 'UAG', 'UAA','UGA']\namino_acid = ['A', 'A', 'A', 'A', 'C', 'C', 'D', 'D', 'E', 'E', 'F', 'F',\n               'G', 'G', 'G', 'G', 'H', 'H', 'I', 'I', 'I', 'K', 'K', 'L',\n               'L', 'L', 'L', 'L', 'L', 'M', 'N', 'N', 'P', 'P', 'P', 'P',\n               'Q', 'Q', 'R', 'R', 'R', 'R', 'R', 'R', 'S', 'S', 'S', 'S',\n               'S', 'S', 'T', 'T', 'T', 'T', 'V', 'V', 'V', 'V', 'W', 'Y',\n               'Y', '!', '!', '!']\ndef DNA_seq(file):\n    dna =[]\n    with open(file) as f:\n        next(f)\n        for c in f:\n            return c\n\n#step 2\ndef DNA_to_RNA(file):\n    dna_seq = DNA_seq(file)\n    rna = dna_seq.replace(\"T\",\"U\")\n    return rna\n#step 3\n\ndef startcodon_pos(sequence):\n    for i in range(len(sequence)):\n        if sequence[i:i+3] == \"AUG\":\n            return i\n\n#step 2\ndef print_codon(sequence):\n    codon = []\n    j = int(startcodon_pos(sequence))\n    for k in range(j+3,len(sequence),3):\n        elem = sequence[k:k+3]\n        if elem not in stop_codon:\n            codon.append(elem)\n        else:\n            break\n    return codon\n\n#step 3\ndef test_length(genetic_code, amino_acids):\n    assert(len(genetic_code) == len(amino_acids)), \"Lengths do not match\"\n    return True\n\ndef translate(sequence,genetic_code, amino_acids):\n    if test_length(genetic_code, amino_acids) == True:\n        acid_list = []\n        codon_list = print_codon(sequence)\n        for c in codon_list:\n            if c in genetic_code:\n                #getting index of the codon\n                codonidx = genetic_code.index(c)\n                acid_list.append(amino_acid[codonidx])\n    return acid_list\nfile = \"Simple_gene_new.fasta\"\n# \"\"\"\"\n# debugging/testing\n# # print(DNA_seq(file))\n# # print(DNA_to_RNA(file))\n# # print(startcodon_pos(DNA_to_RNA(file)))\n# \"\"\"\"\nprint(translate(DNA_to_RNA(file),genetic_code, amino_acid))\n#step 4\nimport matplotlib.pyplot as plt\n\ndef acid_list():\n    acid_list = []\n    for item in amino_acid:\n        if item not in acid_list:\n            acid_list.append(item)\n    return acid_list\n\ndef count_amino(sequence, genetic_code, amino_acids):\n    a_list = acid_list()\n    translated_code = translate(DNA_to_RNA(file),genetic_code, amino_acid)\n    count_dict = {}\n    count_list = []\n    for item in translated_code:\n        if item in count_dict:\n            count_dict[item] += 1\n        else:\n            count_dict[item] = 1\n    sorted_count = sorted(count_dict)\n    for dude in a_list:\n        if dude not in count_dict:\n            count_list.append(0)\n        else:\n            count_list.append(count_dict[dude])\n    return count_list\n\ndef check_length(sequence, genetic_code, amino_acids):\n    amino_list = count_amino(sequence, genetic_code, amino_acids)\n    a_list = acid_list()\n    assert(len(a_list) == len(amino_list)), \"Lengths do not match\"\n    return True\n\n\ndef plot(sequence,genetic_code,amino_acids):\n    y_list = count_amino(sequence,genetic_code, amino_acids)\n    x_list = acid_list()\n    plt.bar(x_list, y_list)\n    plt.ylabel(\"Frequency\")\n    plt.xlabel(\"Amino acids\")\n    plt.title(\"Plot of frequency of amino acids\")\n\n\nseq = DNA_to_RNA(file)\nprint(acid_list())\nprint(check_length(seq, genetic_code, amino_acid))\nprint(count_amino(DNA_to_RNA(file),genetic_code, amino_acid))\nplot(seq, genetic_code, amino_acid)\nplt.show()","output":{"0":{"name":"stdout","output_type":"stream","text":"['G', 'S', 'S', 'R', 'T', 'R', 'L', 'H', 'Q', 'D', 'S', 'R', 'G', 'A', 'P']\n['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y', '!']\nTrue\n[1, 0, 1, 0, 0, 2, 1, 0, 0, 1, 0, 0, 1, 1, 3, 3, 1, 0, 0, 0, 0]\n"},"1":{"data":{"image/png":"67aa308a3f7ae75feb0285c81dbaf1a31c36cfa2","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":12,"metadata":{"image/png":{"height":440,"width":720},"needs_background":"light"},"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"markdown","id":"483d13","input":"In last week's worksheet you wrote a Python script which converted a RNA sequence into a protein by performing the translation (RNA -> amino acid sequence) process. In this question you will extend the script to:\n1. Read a DNA sequence from a `fasta` file\n1. Transcribe the sequence (convert from DNA to RNA) by replacing all occurrences of \"T\" with \"U\".\n1. Translate the sequence (**already done last week**)\n1. Count the frequency of each amino acid and plot it as a histogram\n\n<img src=\"aa_freq.png\" alt=\"Amino Acid Frequencies\" width=\"300\"/>\n\n### Step 1\nWrite a script which opens the file `random_60.fasta` and reads the DNA sequence into a string variable. Make sure you discard the line beginning '`>`' and remove newline characters.\n### Step 2\nConvert the DNA sequence to an RNA sequence using `string.replace` to replace each occurrence of `T` with `U`. (e.g. \"CTGCTC\" should become \"CUGCUC\").\n### Step 3\nTranslate the RNA sequence to a protein by generating a string variable containing the amino acid sequence (you can reuse last week's code).\n### Step 4\nWrite a script which creates a list which contains the number of occurrences of each amino acid in the protein. Plot a histogram showing the frequency of each amino acid. Add y-axis label 'Frequency' and x-axis label 'Amino acid'.\n\n","pos":1,"type":"cell"}
{"cell_type":"markdown","id":"59bf9e","input":"# Files Exercises\n## Question 1: Counting Amino Acids\n\n","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"8bb4c2","input":"## Question 2: Star Map\n\nIn this question you will use data from a star catalogue to create a picture that plots the locations of stars, like this:\n\n<img src=\"star_map.png\" alt=\"Star Map\" width=\"300\"/>\n\nThe file `stars.csv` contains one line for each star that is represented in the catalogue. The meaning of each field (column) is described below.\n\n- The first three fields are the x, y and z coordinates for the star. We will ignore the z coordinate, and use only the x and y coordinates. Each axis in the coordinate system goes from -1 to +1, and the centre point is 0,0.\n- The fourth field is the Henry Draper number, which is simply a unique identifier for the star.\n- The fifth field is the magnitude (or brightness) of the star.\n- The sixth field exists only for a small number of stars and is a semicolon-separated list of names for a star. A star may have several names.\n- The fields that you will need for this assignment include the x and y coordinates, the magnitude and the name of each star.\n\n### Step 1\n\n - Create four empty lists `x`, `y`, `mag` and `star_name` to store the x coordinate, y coordinate, magnitude and star name of each star.\n - Open the file `stars.csv` and use `csv.reader` to load the contents into the four lists. Make sure you convert each to the appropriate data type (float or string).\n - Where there is more than one star name, store the second one (using `string.split` and `string.strip`)\n\n### Step 2\n\nMake a scatter plot of the x, y coordinates. Use the following code to set up your plot:\n\n```\nfig, ax = plt.subplots(figsize=(5,5))\nfig.patch.set_facecolor(\"black\") # set the figure background to black\nax.axis(\"off\") # remove the axes\nax.set_facecolor(\"black\") # set the plot background to black\n```\n\nUse `ax.scatter(x, y)` to plot the stars. Try to make it look similar to the image above by passing suitable values for the `marker`, `s` and `color` parameters (see https://matplotlib.org/3.3.3/api/_as_gen/matplotlib.pyplot.scatter.html).\n\n\n### Step 3\n\nThe file `Cas_lines.txt` contains two star names per line. Each pair of star names represent one line to be drawn for the constellation. Write code which iterates over each line in the file, and for each line, determines the x and y coordinates of the two stars, then draws a line between them on the plot.\n\nThe following code will plot a line between coordinates (x_1, y_1) and (x_2, y_2).\n```\nax.plot([x_1, x_2], [y_1, y_2])\n```\n\n- Open the file `Cas_lines.txt` and use `csv.reader` to iterate over each row. For each row:\n  - use `star_name.index` to find the index of the two star names in the list of star names you created in step 1.\n  - determine the x and y coordinates of each\n  - use the code above to plot a line between them.\n\n\n\n","pos":3,"type":"cell"}
{"id":0,"time":1611306842426,"type":"user"}
{"last_load":1611306746318,"type":"file"}